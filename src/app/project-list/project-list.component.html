<table mat-table [dataSource]="dataSource" class="projects-table">

  <ng-container matColumnDef="toggle">
    <th mat-header-cell *matHeaderCellDef></th>
    <td mat-cell *matCellDef="let row">
      <span *ngIf="expandedElement !== row" class="material-icons" matTooltip="Expand" (click)="expandedElement = row">
        chevron_right
      </span>
      <span *ngIf="expandedElement === row" class="material-icons" matTooltip="Collapse"
        (click)="expandedElement = null">
        expand_more
      </span>
    </td>
  </ng-container>

  <ng-container matColumnDef="id">
    <th mat-header-cell *matHeaderCellDef>Request #</th>
    <td mat-cell *matCellDef="let element">
      <div>{{element.id}}</div>
    </td>
  </ng-container>

  <ng-container matColumnDef="title">
    <th mat-header-cell *matHeaderCellDef>Project Title</th>
    <td mat-cell *matCellDef="let element">
      <div matTooltip="{{element.title}}">{{element.title}}</div>
    </td>
  </ng-container>

  <ng-container matColumnDef="status">
    <th mat-header-cell *matHeaderCellDef>Status</th>
    <td mat-cell *matCellDef="let element">
      <div matTooltip="{{element.status}}">{{element.status}}</div>
    </td>
  </ng-container>

  <ng-container matColumnDef="start_date">
    <th mat-header-cell *matHeaderCellDef>Start Date</th>
    <td mat-cell *matCellDef="let element">
      <div matTooltip="{{element.start_date | date:'M-d-yyyy'}}">
        {{element.start_date | date:'M-d-yyyy'}}
      </div>
    </td>
  </ng-container>

  <ng-container matColumnDef="active">
    <th mat-header-cell *matHeaderCellDef>Active</th>
    <td mat-cell *matCellDef="let element">
      <mat-slide-toggle [checked]="element.active" (change)="activeChanged($event)"></mat-slide-toggle>
    </td>
  </ng-container>

  <ng-container matColumnDef="assignee">
    <th mat-header-cell *matHeaderCellDef>Assigned To</th>
    <td mat-cell *matCellDef="let element">
      <div matTooltip="{{element.assignee}}">{{element.assignee}}</div>
    </td>
  </ng-container>

  <ng-container matColumnDef="percent_complete">
    <th mat-header-cell *matHeaderCellDef>% Complete</th>
    <td mat-cell *matCellDef="let element">
      <div>{{element.percent_complete}}%</div>
    </td>
  </ng-container>

  <ng-container matColumnDef="expandedDetail">
    <td mat-cell *matCellDef="let detail" colspan="8">

      <div class="projects-details" [@detailExpand]="detail.element === expandedElement ? 'expanded' : 'collapsed'">

        Details/Notes

        <h3>Summary</h3>
        {{detail.element.details.summary}}

        <h3>Justification</h3>
        {{detail.element.details.justification}}

        <h3>Notes:</h3>
        <div *ngFor="let note of detail.element.notes">
          {{note.note}}
        </div>

        <button mat-flat-button color="primary" (click)="addNote()" style="float: right;">Add Note</button>

      </div>

    </td>
  </ng-container>

  <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>

  <tr mat-row *matRowDef="let row; columns: displayedColumns;" [class.expanded]="expandedElement === row" class="element-row"></tr>

  <tr mat-row *matRowDef="let row; columns: ['expandedDetail']; when: isExpansionDetailRow" class="detail-row"></tr>

</table>